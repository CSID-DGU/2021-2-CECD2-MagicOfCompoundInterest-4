import win32com.client
import pythoncom

class XASessionEventHandler: ## 로그인을 확인해주는 class
    login_state = 0

    def OnLogin(self, code, msg):
        if code == "0000":
            print("로그인 성공")
            XASessionEventHandler.login_state = 1
        else:
            print("로그인 실패")

instXASession = win32com.client.DispatchWithEvents("XA_Session.XASession", XASessionEventHandler)
id = "tjrdns"
passwd = "tjr2010"
cert_passwd = "cert" # 내 이베스트 모의투자 아이디, 비밀번호

instXASession.ConnectServer("demo.ebestsec.co.kr", 20001) # 모의투자 링크
instXASession.Login(id, passwd, cert_passwd, 0, 0) # 로그인
